"use strict";(self.webpackChunkchurch=self.webpackChunkchurch||[]).push([[206],{2206:(Z,a,i)=>{i.r(a),i.d(a,{ArticlesPageModule:()=>P});var c=i(8583),h=i(9029),d=i(4633),l=i(3971),g=i(5987),u=i(8307),p=i(5257),m=i(8002),f=i(157),t=i(7716),v=i(425),A=i(2582);function x(e,o){if(1&e&&(t.TgZ(0,"div",6),t._UZ(1,"nguix-posts",7),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("i18n",!0)("posts",n.posts)}}function M(e,o){1&e&&(t.TgZ(0,"div",8),t._UZ(1,"nguix-skeleton-posts",9),t.qZA()),2&e&&(t.xp6(1),t.Q6J("no",5))}function C(e,o){1&e&&(t.TgZ(0,"div",10),t._UZ(1,"nguix-spinner"),t.qZA())}function y(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.NdJ("scrolled",function(){return t.CHM(n),t.oxw().fetchPosts()}),t.YNc(2,x,2,2,"div",3),t.YNc(3,M,2,1,"ng-template",null,4,t.W1O),t.qZA(),t.YNc(5,C,2,0,"div",5),t.qZA()}if(2&e){const n=t.MAs(4),s=t.oxw();t.xp6(1),t.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",50),t.xp6(1),t.Q6J("ngIf",s.posts.length||!s.isLoadingMore)("ngIfElse",n),t.xp6(3),t.Q6J("ngIf",s.isLoadingMore)}}const T=[{path:"",component:(()=>{class e{constructor(n,s){this.store=n,this.settingService=s,this.page$=this.settingService.onLocaleChanged.pipe((0,u.b)(r=>(this.locale=r)&&this.fetchPosts())),this.pageNo=1,this.areThereMore=!0,this.posts=[],this.isLoadingMore=!1}ngOnInit(){}fetchPosts(){!this.areThereMore||this.isLoadingMore||(this.isLoadingMore=!0,setTimeout(()=>this.isLoadingMore=!1,3e3),this.latestQueryId=`post:article:publish:${this.locale}:${this.pageNo++}`,this.store.dispatch(new f.G3(this.latestQueryId,n=>{let s=n.where("type","==","article").where("status","==","publish").where("locale","==",this.locale).orderBy("createdAt","desc");return this.latestItem&&(s=s.startAfter(this.latestItem.createdAt)),s.limit(2)})).pipe((0,p.q)(1),(0,m.U)(n=>n.schemata_post)).subscribe(n=>{const s=n.queryList[this.latestQueryId];this.areThereMore=!!s.length,this.latestItem=this.areThereMore?s[s.length-1]:this.latestItem,this.posts=Object.keys(n.queryList).filter(r=>r.includes(`:article:publish:${this.locale}:`)).reduce((r,L)=>r.concat(n.queryList[L]),[]),this.isLoadingMore=!1}))}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v.yh),t.Y36(A.RC))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-articles-page"]],decls:2,vars:3,consts:[["class","host",4,"ngIf"],[1,"host"],["infiniteScroll","",1,"listing",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","main",4,"ngIf","ngIfElse"],["listLoading",""],["class","infinite-loading",4,"ngIf"],[1,"main"],["layout","card","authorUrlSegment","member",3,"i18n","posts"],[1,"list-loading"],["layout","card",3,"no"],[1,"infinite-loading"]],template:function(n,s){1&n&&(t.YNc(0,y,6,5,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.page$))},directives:[c.O5,h.R,l.PostsComponent,l.SkeletonPostsComponent,l.SpinnerComponent],pipes:[c.Ov],styles:[".host[_ngcontent-%COMP%]{padding:1rem}.host[_ngcontent-%COMP%]   .listing[_ngcontent-%COMP%]{min-height:100vh}.host[_ngcontent-%COMP%]   .infinite-loading[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),e})()}];let I=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(T)],g.Bz]}),e})(),P=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.ez,h.X,d.Lr,l.NguixSpinnerComponentModule,l.NguixPostsI18nComponentModule,l.NguixSkeletonPostsComponentModule,I]]}),e})()}}]);