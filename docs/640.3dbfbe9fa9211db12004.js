"use strict";(self.webpackChunkchurch=self.webpackChunkchurch||[]).push([[640],{9548:(A,c,o)=>{o.r(c),o.d(c,{VideosPageModule:()=>Z});var a=o(8583),h=o(9029),d=o(3971),g=o(5987),u=o(8307),m=o(5257),p=o(8002),f=o(157),e=o(7716),v=o(425),x=o(2582);function M(t,s){if(1&t&&(e.TgZ(0,"div",6),e._UZ(1,"nguix-videos",7),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("i18n",!0)("videos",n.videos)}}function C(t,s){1&t&&(e.TgZ(0,"div",8),e._UZ(1,"nguix-skeleton-videos",9),e.qZA()),2&t&&(e.xp6(1),e.Q6J("no",5))}function y(t,s){1&t&&(e.TgZ(0,"div",10),e._UZ(1,"nguix-spinner"),e.qZA())}function V(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.NdJ("scrolled",function(){return e.CHM(n),e.oxw().fetchVideos()}),e.YNc(2,M,2,2,"div",3),e.YNc(3,C,2,1,"ng-template",null,4,e.W1O),e.qZA(),e.YNc(5,y,2,0,"div",5),e.qZA()}if(2&t){const n=e.MAs(4),i=e.oxw();e.xp6(1),e.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",50),e.xp6(1),e.Q6J("ngIf",i.videos.length||!i.isLoadingMore)("ngIfElse",n),e.xp6(3),e.Q6J("ngIf",i.isLoadingMore)}}const T=[{path:"",component:(()=>{class t{constructor(n,i){this.store=n,this.settingService=i,this.page$=this.settingService.onLocaleChanged.pipe((0,u.b)(l=>(this.locale=l)&&this.fetchVideos())),this.pageNo=1,this.areThereMore=!0,this.videos=[],this.isLoadingMore=!1}ngOnInit(){}fetchVideos(){if(!this.areThereMore||this.isLoadingMore)return;this.isLoadingMore=!0,setTimeout(()=>this.isLoadingMore=!1,3e3);const n=`video:default:publish:${this.locale}`;this.latestQueryId=`${n}:${this.pageNo++}`,this.store.dispatch(new f.lz(this.latestQueryId,i=>{let l=i.where("type","==","default").where("status","==","publish").where("locale","==",this.locale).orderBy("createdAt","desc");return this.latestItem&&(l=l.startAfter(this.latestItem.createdAt)),l.limit(12)})).pipe((0,m.q)(1),(0,p.U)(i=>i.schemata_video)).subscribe(i=>{const l=i.queryList[this.latestQueryId];this.areThereMore=!!l.length,this.latestItem=this.areThereMore?l[l.length-1]:this.latestItem,this.videos=Object.keys(i.queryList).filter(r=>r.includes(n)).reduce((r,L)=>r.concat(i.queryList[L]),[]),this.isLoadingMore=!1})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(v.yh),e.Y36(x.RC))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-videos-page"]],decls:2,vars:3,consts:[["class","host",4,"ngIf"],[1,"host"],["infiniteScroll","",1,"listing",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","main",4,"ngIf","ngIfElse"],["listLoading",""],["class","infinite-loading",4,"ngIf"],[1,"main"],["layout","card",3,"i18n","videos"],[1,"list-loading"],["layout","card",3,"no"],[1,"infinite-loading"]],template:function(n,i){1&n&&(e.YNc(0,V,6,5,"div",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,i.page$))},directives:[a.O5,h.R,d.VideosComponent,d.SkeletonVideosComponent,d.SpinnerComponent],pipes:[a.Ov],styles:[".host[_ngcontent-%COMP%]{padding:1rem 1rem 0;max-width:992px;margin:auto}.host[_ngcontent-%COMP%]   .listing[_ngcontent-%COMP%]{min-height:100vh}.host[_ngcontent-%COMP%]   .infinite-loading[_ngcontent-%COMP%]{padding-bottom:1rem;display:flex;justify-content:center}"]}),t})()}];let I=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[g.Bz.forChild(T)],g.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[a.ez,h.X,d.NguixSpinnerComponentModule,d.NguixVideosI18nComponentModule,d.NguixSkeletonVideosComponentModule,I]]}),t})()}}]);