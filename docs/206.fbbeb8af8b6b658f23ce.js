"use strict";(self.webpackChunkchurch=self.webpackChunkchurch||[]).push([[206],{2206:(L,h,i)=>{i.r(h),i.d(h,{ArticlesPageModule:()=>P});var c=i(8583),d=i(9029),r=i(3971),g=i(5987),u=i(8307),p=i(5257),m=i(8002),f=i(157),t=i(7716),v=i(425),x=i(2582);function A(e,o){if(1&e&&(t.TgZ(0,"div",6),t._UZ(1,"nguix-posts",7),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("i18n",!0)("posts",n.posts)}}function M(e,o){1&e&&(t.TgZ(0,"div",8),t._UZ(1,"nguix-skeleton-posts",9),t.qZA()),2&e&&(t.xp6(1),t.Q6J("no",5))}function C(e,o){1&e&&(t.TgZ(0,"div",10),t._UZ(1,"nguix-spinner"),t.qZA())}function y(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.NdJ("scrolled",function(){return t.CHM(n),t.oxw().fetchPosts()}),t.YNc(2,A,2,2,"div",3),t.YNc(3,M,2,1,"ng-template",null,4,t.W1O),t.qZA(),t.YNc(5,C,2,0,"div",5),t.qZA()}if(2&e){const n=t.MAs(4),s=t.oxw();t.xp6(1),t.Q6J("infiniteScrollDistance",2)("infiniteScrollThrottle",50),t.xp6(1),t.Q6J("ngIf",s.posts.length||!s.isLoadingMore)("ngIfElse",n),t.xp6(3),t.Q6J("ngIf",s.isLoadingMore)}}const T=[{path:"",component:(()=>{class e{constructor(n,s){this.store=n,this.settingService=s,this.page$=this.settingService.onLocaleChanged.pipe((0,u.b)(l=>(this.locale=l)&&this.fetchPosts())),this.pageNo=1,this.areThereMore=!0,this.posts=[],this.isLoadingMore=!1}ngOnInit(){}fetchPosts(){if(!this.areThereMore||this.isLoadingMore)return;this.isLoadingMore=!0,setTimeout(()=>this.isLoadingMore=!1,3e3);const n=`post:article:publish:${this.locale}`;this.latestQueryId=`${n}:${this.pageNo++}`,this.store.dispatch(new f.G3(this.latestQueryId,s=>{let l=s.where("type","==","article").where("status","==","publish").where("locale","==",this.locale).orderBy("createdAt","desc");return this.latestItem&&(l=l.startAfter(this.latestItem.createdAt)),l.limit(12)})).pipe((0,p.q)(1),(0,m.U)(s=>s.schemata_post)).subscribe(s=>{const l=s.queryList[this.latestQueryId];this.areThereMore=!!l.length,this.latestItem=this.areThereMore?l[l.length-1]:this.latestItem,this.posts=Object.keys(s.queryList).filter(a=>a.includes(n)).reduce((a,Z)=>a.concat(s.queryList[Z]),[]),this.isLoadingMore=!1})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v.yh),t.Y36(x.RC))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-articles-page"]],decls:2,vars:3,consts:[["class","host",4,"ngIf"],[1,"host"],["infiniteScroll","",1,"listing",3,"infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","main",4,"ngIf","ngIfElse"],["listLoading",""],["class","infinite-loading",4,"ngIf"],[1,"main"],["layout","card","authorUrlSegment","member",3,"i18n","posts"],[1,"list-loading"],["layout","card",3,"no"],[1,"infinite-loading"]],template:function(n,s){1&n&&(t.YNc(0,y,6,5,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.page$))},directives:[c.O5,d.R,r.PostsComponent,r.SkeletonPostsComponent,r.SpinnerComponent],pipes:[c.Ov],styles:[".host[_ngcontent-%COMP%]{padding:1rem 1rem 0;max-width:992px;margin:auto}.host[_ngcontent-%COMP%]   .listing[_ngcontent-%COMP%]{min-height:100vh}.host[_ngcontent-%COMP%]   .infinite-loading[_ngcontent-%COMP%]{padding-bottom:1rem;display:flex;justify-content:center}"]}),e})()}];let I=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(T)],g.Bz]}),e})(),P=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.ez,d.X,r.NguixSpinnerComponentModule,r.NguixPostsI18nComponentModule,r.NguixSkeletonPostsComponentModule,I]]}),e})()}}]);